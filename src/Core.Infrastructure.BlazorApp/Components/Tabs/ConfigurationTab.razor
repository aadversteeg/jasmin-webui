@using Core.Application.McpServers

<div class="tab-pane-content">
    @if (Configuration == null)
    {
        <div class="text-muted">
            <p>No configuration available for this server.</p>
        </div>
    }
    else
    {
        <div class="mb-4">
            <h6 class="text-muted mb-2">Command</h6>
            <code class="d-block p-2 bg-light border rounded text-dark">@Configuration.Command</code>
        </div>

        @if (Configuration.Args.Count > 0)
        {
            <div class="mb-4">
                <h6 class="text-muted mb-2">Arguments</h6>
                <ul class="list-unstyled mb-0">
                    @foreach (var arg in Configuration.Args)
                    {
                        <li class="mb-1">
                            <code class="p-1 bg-light border rounded text-secondary">@arg</code>
                        </li>
                    }
                </ul>
            </div>
        }

        @if (Configuration.Env.Count > 0)
        {
            <div class="mb-4">
                <h6 class="text-muted mb-2">Environment Variables</h6>
                <table class="table table-sm table-bordered">
                    <thead class="table-light">
                        <tr>
                            <th>Name</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var kvp in Configuration.Env)
                        {
                            <tr>
                                <td><code class="text-secondary">@kvp.Key</code></td>
                                <td><code class="text-break text-secondary">@MaskSensitiveValue(kvp.Key, kvp.Value)</code></td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
    }
</div>

@code {
    [Parameter]
    public McpServerConfiguration? Configuration { get; set; }

    private static string MaskSensitiveValue(string key, string value)
    {
        // Mask values that might be sensitive (API keys, tokens, secrets, passwords)
        var lowerKey = key.ToLowerInvariant();
        if (lowerKey.Contains("key") || lowerKey.Contains("token") ||
            lowerKey.Contains("secret") || lowerKey.Contains("password") ||
            lowerKey.Contains("credential") || lowerKey.Contains("auth"))
        {
            if (value.Length <= 8)
            {
                return "********";
            }
            return value.Substring(0, 4) + "..." + value.Substring(value.Length - 4);
        }
        return value;
    }
}
